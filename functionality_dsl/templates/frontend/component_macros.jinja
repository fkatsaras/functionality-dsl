{% macro render_component(cmp) %}
  {% set kind = cmp.kind %}
  {% set ent = cmp.entity %}
  {% set entname = ent.name if ent is defined and ent is not none else none %}

  {# these two lists come from the frontend generator context #}
  {% set has_ws_input = (entname is not none) and (computed_ws_entities is defined) and (entname in computed_ws_entities) %}
  {% set has_rest     = (entname is not none) and (rest_entities is defined) and (entname in rest_entities) %}

  {# Decide endpoints (mutually exclusive) #}
  {% set wsUrl = None %}
  {% if has_ws_input %}
    {% set wsUrl = "/api/entities/" ~ entname|lower ~ "/stream" %}
  {% endif %}

  {% set httpUrl = None %}
  {% if (not wsUrl) and has_rest %}
    {% set httpUrl = "/api/entities/" ~ entname|lower ~ "/" %}
  {% endif %}

  {% set props = cmp.to_props() %}

  {% set common = {
    "name": cmp.name or (kind ~ 'Component'),
    "entity": entname,
    "url": httpUrl,
    "wsUrl": wsUrl
  } %}

  {% include "components/" ~ kind ~ ".jinja" %}
{% endmacro %}
