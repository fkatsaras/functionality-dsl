// Minimal API Key Auth Test
// Test with: curl -H "X-API-Key: admin_key_123" http://localhost:8000/api/secretpost

Auth<apikey> APIKeyAuth
  in: header
  name: "X-API-Key"
end

Role admin uses APIKeyAuth
Role user uses APIKeyAuth

Server APIKeyTest
  host: "0.0.0.0"
  port: 8000
  cors: "*"
  loglevel: debug
end

Source<REST> PostsAPI
  url: "https://jsonplaceholder.typicode.com/posts/1"
  operations: [read]
end

Entity Post
  source: PostsAPI
  attributes:
    - id: integer @readonly;
    - title: string @readonly;
    - body: string @readonly;
  access: public
end

Entity SecretPost
  source: PostsAPI
  attributes:
    - id: integer @readonly;
    - title: string @readonly;
    - body: string @readonly;
  access: [admin]
end

Component<Table> PostTable
  entity: Post
  colNames: ["id", "title", "body"]
end

Component<Table> SecretPostTable
  entity: SecretPost
  colNames: ["id", "title", "body"]
end
