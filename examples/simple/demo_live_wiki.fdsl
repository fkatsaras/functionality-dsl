Server WikiLive
  host: "localhost"
  port: 8080
  cors: "http://localhost:3000"
end

// --- External WS feed ------------------------------------------
ExternalWS WikiMonEN
  url: "wss://wikimon.hatnote.com/en/"
  protocol: "json"
end

// --- Raw entity ------------------------------------------------
Entity WikiEdit
  source: WikiMonEN
  attributes:
    - title: string
    - user: string
    - delta: int
    - is_bot: bool
    - is_minor: bool
    - wiki: string
end

// --- Computed entity -------------------------------------------
Entity EditGauge
  inputs:
    - e: WikiEdit
  attributes:
    - edit_size_abs: int = abs(e.delta)
end

// --- Internal endpoint -----------------------------------------
InternalWS EditGaugeStream
  entity: EditGauge
  path: "/api/wiki/edits"
end

// --- Component -------------------------------------------------
Component<Gauge> LiveEditSize
  endpoint: EditGaugeStream
  value: data.edit_size_abs
  min: 0
  max: 2000
  label: "Wikipedia edit size (abs bytes)"
  unit: "B"
end
