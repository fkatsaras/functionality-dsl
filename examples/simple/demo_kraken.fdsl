// ----------- Server (config) -----------
Server KrakenAPI
  host: "localhost"
  port: 8080
  cors: "http://localhost:3000"
end

// ----------- Sources (public REST) -----------
RESTEndpoint Posts
  url: "https://jsonplaceholder.typicode.com/posts"
  verb: GET
end

RESTEndpoint Users
  url: "https://jsonplaceholder.typicode.com/users"
  verb: GET
end

// ----------- Public WebSocket (no auth) -----------
WSEndpoint KrakenBTCUSD
  url: "wss://ws.kraken.com"
  protocol: "json"
  subscribe: "{\"event\":\"subscribe\",\"pair\":[\"BTC/USD\"],\"subscription\":{\"name\":\"trade\"}}"
end

// ----------- Entities (data) -----------
Entity Post
  source: Posts
  attributes:
    - userId: int
    - id: int
    - title: string
    - body: string
end

Entity User
  source: Users
  attributes:
    - id: int
    - name: string
    - username: string
    - email: string
end

Entity PostWithAuthor
  inputs:
    - p: Post
    - u: User
  attributes:
    - post_id   = p.id
    - title     = p.title
    - author    = u.name
    - body_len  = len(p.body)
end

// Example entity bound to Kraken stream (latest trade payloads)
Entity KrakenTrade
  source: KrakenBTCUSD
  attributes:
    - channel: string
    - type: string
    - data: string
end

// ----------- Components (UI) -----------
Component<LiveTable> PostsTable
  entity: PostWithAuthor
  props:
    - primaryKey: "post_id"
    - columns: data.post_id, data.author, data.title, data.body_len
end
