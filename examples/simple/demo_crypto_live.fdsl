// ------------------- Server -------------------
Server BinanceWS
  host: "localhost"
  port: 8080
  cors: "http://localhost:3000"
end

// ------------------- WebSockets ----------------
WSEndpoint BTCUSDT
  url: "wss://stream.binance.com:9443/ws/btcusdt@ticker"
  protocol: "json"
end

WSEndpoint ETHUSDT
  url: "wss://stream.binance.com:9443/ws/ethusdt@ticker"
  protocol: "json"
end

// ------------------- Raw Entities (WS snapshots) ------------------
// Binance ticker payload has the last price at key "c" (string number)
Entity BTCRaw
  source: BTCUSDT
  attributes:
    - c: float
end

Entity ETHRaw
  source: ETHUSDT
  attributes:
    - c: float
end

// ------------------- Computed Entities (add timestamp) ------------------
Entity BTCPrice
  inputs:
    - p: BTCRaw
  attributes:
    - t = now()
    - c = p.c
end

Entity ETHPrice
  inputs:
    - p: ETHRaw
  attributes:
    - t = now()
    - c = p.c
end

// ------------------- Components ----------------
Component<LineChart> BTCChart
  entity: BTCPrice
  x: data.t
  y: [data.c]
  xLabel: "Time"
  yLabel: "BTC/USDT"
end

Component<LineChart> ETHChart
  entity: ETHPrice
  x: data.t
  y: [data.c]
  xLabel: "Time"
  yLabel: "ETH/USDT"
end
